(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{449:function(t,a,s){t.exports=s.p+"assets/img/WechatIMG289.6fea54e4.png"},450:function(t,a,s){t.exports=s.p+"assets/img/WechatIMG290.3449783c.png"},528:function(t,a,s){"use strict";s.r(a);var e=s(19),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[t._v("#")]),t._v(" docker")]),t._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),a("p",[t._v("一种虚拟化容器技术，使用的是客户端-服务器（C/S）架构模式，使用远程 API 来管理和创建 Docker 容器。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(449),alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:s(450),alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),a("ul",[a("li",[t._v("减少对宿主机完整环境的开销")]),t._v(" "),a("li",[t._v("运行于内核，秒级启动")]),t._v(" "),a("li",[t._v("一次创建一套可配置镜像，解决多个环境不一致问题")]),t._v(" "),a("li",[t._v("镜像可复用，更易于拓展镜像")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("特性")]),t._v(" "),a("th",[t._v("容器")]),t._v(" "),a("th",[t._v("虚拟机")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("启动")]),t._v(" "),a("td",[t._v("秒级")]),t._v(" "),a("td",[t._v("分钟级")])]),t._v(" "),a("tr",[a("td",[t._v("硬盘使用")]),t._v(" "),a("td",[t._v("一般为 MB")]),t._v(" "),a("td",[t._v("一般为 GB")])]),t._v(" "),a("tr",[a("td",[t._v("性能")]),t._v(" "),a("td",[t._v("接近原生")]),t._v(" "),a("td",[t._v("弱于")])]),t._v(" "),a("tr",[a("td",[t._v("系统支持量")]),t._v(" "),a("td",[t._v("单机支持上千个容器")]),t._v(" "),a("td",[t._v("一般几十个")])])])]),t._v(" "),a("h3",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("标题")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("镜像(./images)")]),t._v(" "),a("td",[t._v("Docker 镜像是用于创建 Docker 容器的模板。")])]),t._v(" "),a("tr",[a("td",[t._v("容器(Container)")]),t._v(" "),a("td",[t._v("容器是独立运行的一个或一组应用。")])]),t._v(" "),a("tr",[a("td",[t._v("客户端(Client)")]),t._v(" "),a("td",[t._v("Docker 客户端通过命令行或者其他工具使用 Docker API (https://docs.docker.com/reference/api/docker_remote_api) 与 Docker 的守护进程通信。")])]),t._v(" "),a("tr",[a("td",[t._v("主机(Host)")]),t._v(" "),a("td",[t._v("一个物理或者虚拟的机器用于执行 Docker 守护进程和容器。")])]),t._v(" "),a("tr",[a("td",[t._v("仓库(Registry)")]),t._v(" "),a("td",[t._v("Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。Docker Hub(https://hub.docker.com) 提供了庞大的镜像集合供使用。国内知名仓库有")])]),t._v(" "),a("tr",[a("td",[t._v("Docker Machine")]),t._v(" "),a("td",[t._v("Docker Machine是一个简化Docker安装的命令行工具，通过一个简单的命令行即可在相应的平台上安装Docker，比如VirtualBox、 Digital Ocean、Microsoft Azure。")])])])]),t._v(" "),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),a("p",[t._v("分CE（社区版）、EE（企业版，收费），需安装完docker后安装镜像加速器")]),t._v(" "),a("h2",{attrs:{id:"镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像"}},[t._v("#")]),t._v(" 镜像")]),t._v(" "),a("p",[t._v("镜像的唯一标识是"),a("strong",[t._v("ID")]),t._v("和"),a("strong",[t._v("摘要（digests）")])]),t._v(" "),a("h3",{attrs:{id:"基本操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本操作"}},[t._v("#")]),t._v(" 基本操作")]),t._v(" "),a("h4",{attrs:{id:"获取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取镜像"}},[t._v("#")]),t._v(" 获取镜像")]),t._v(" "),a("p",[t._v("格式： docker pull [选项] [Docker Registry 地址[:端口号]/]仓库名[:标签]")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取node镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull node:8.9.4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取镜像摘要")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--digests")]),t._v("\n")])])]),a("h4",{attrs:{id:"删除镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除镜像"}},[t._v("#")]),t._v(" 删除镜像")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据短ID删除镜像（短ID即镜像ID的前三位）")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("501")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据标签删除镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" nodejs:8.9.4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据镜像摘要删除镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" node@sha256:xxxxxxx\n")])])]),a("h3",{attrs:{id:"镜像分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像分类"}},[t._v("#")]),t._v(" 镜像分类")]),t._v(" "),a("h4",{attrs:{id:"顶层镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#顶层镜像"}},[t._v("#")]),t._v(" 顶层镜像")]),t._v(" "),a("p",[t._v("已下载的镜像")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取顶层镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取node镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# since过滤出版本后的镜像，before过滤出之前的")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("since")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("node:8.9.4\n")])])]),a("h4",{attrs:{id:"虚悬镜像-dangling-image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚悬镜像-dangling-image"}},[t._v("#")]),t._v(" 虚悬镜像（dangling image）")]),t._v(" "),a("p",[t._v("一般是无用的镜像")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  获取虚悬镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dangling")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true\n")])])]),a("h4",{attrs:{id:"中间层镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#中间层镜像"}},[t._v("#")]),t._v(" 中间层镜像")]),t._v(" "),a("p",[t._v("顶层镜像的依赖镜像，伴随着顶层镜像删除而消失")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在所有镜像中可以看到")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v("\n")])])]),a("h3",{attrs:{id:"定制镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定制镜像"}},[t._v("#")]),t._v(" 定制镜像")]),t._v(" "),a("p",[t._v("写一个Dockerfile")]),t._v(" "),a("div",{staticClass:"language-Dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" node # 基础镜像，必传，scratch为空镜像")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENV")]),t._v(" version=1.0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ARG")]),t._v(" name # 通过--build-arg传入时，需声明变量，不声明会报错")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VOLUME")]),t._v(" /data # 定义匿名卷，将写入操作存储到指定文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 2333 # 声明容器端口，与 -p <宿主端口>:<容器端口>有差异")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /dist # 指定工作目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" redis # 指定linux当前用户")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ADD")]),t._v(" source.tar.gz / # 解压文件到根目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" source.tar.gz / # 复制压缩文件到根目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello josh $version'")]),t._v("  # 在命令行执行指令，使用环境变量")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ONBUILD")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"install"')]),t._v("] # 在构建下一个镜像时执行指令")]),t._v("\n")])])]),a("p",[t._v("直接执行构建，也支持用git repo或压缩包构建")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" node:j1 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 以当前目录为路径上下文，根据当前目录下的Dockerfile建立一个名为node且标签为j1的镜像")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build - "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" Dockerfile\n")])])]),a("h2",{attrs:{id:"容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器"}},[t._v("#")]),t._v(" 容器")]),t._v(" "),a("h3",{attrs:{id:"基本操作-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本操作-2"}},[t._v("#")]),t._v(" 基本操作")]),t._v(" "),a("p",[t._v("运行容器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run node:lastest "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从镜像新建容器并启动")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动一个已停止的容器")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" josh:test "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后台运行容器（守护态运行）")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 运行并执行指令")]),t._v("\n")])])]),a("p",[t._v("查看日志")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" container logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId or NAMES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看容器输出的日志")]),t._v("\n")])])]),a("p",[t._v("停止容器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" container stop "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止容器")]),t._v("\n")])])]),a("p",[t._v("进入守护进程")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入进程执行命令行")]),t._v("\n")])])]),a("p",[t._v("删除容器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" container "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("NAMES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除指定容器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" container prune "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除终止状态容器")]),t._v("\n")])])]),a("h2",{attrs:{id:"仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仓库"}},[t._v("#")]),t._v(" 仓库")]),t._v(" "),a("h3",{attrs:{id:"基本操作-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本操作-3"}},[t._v("#")]),t._v(" 基本操作")]),t._v(" "),a("p",[t._v("登录")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" login "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("registry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("登出")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("logout")]),t._v("\n")])])]),a("p",[t._v("推送")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" push "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("registry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h2",{attrs:{id:"数据管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据管理"}},[t._v("#")]),t._v(" 数据管理")]),t._v(" "),a("p",[t._v("两种方式，数据卷或挂载主机目录")]),t._v(" "),a("h3",{attrs:{id:"数据卷基本操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷基本操作"}},[t._v("#")]),t._v(" 数据卷基本操作")]),t._v(" "),a("p",[t._v("创建数据卷")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vol-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("获取数据卷列表")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v("\n")])])]),a("p",[t._v("查看数据卷信息")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume inspect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vol-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("挂载数据卷")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),t._v(":2000 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--mount")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vol-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("container-path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将[vol-name]改成主机路径即挂载在主机文件下")]),t._v("\n")])])]),a("p",[t._v("删除数据卷")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vol-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume prune "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除无主的数据卷")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除容器同时删除数据卷")]),t._v("\n")])])]),a("h2",{attrs:{id:"网络配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络配置"}},[t._v("#")]),t._v(" 网络配置")]),t._v(" "),a("h3",{attrs:{id:"基本操作-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本操作-4"}},[t._v("#")]),t._v(" 基本操作")]),t._v(" "),a("p",[t._v("外部访问端口")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-P")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 提供随机端口访问应用暴露端口")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("宿主端口"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("容器端口"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 宿主机端口转发到容器端口")]),t._v("\n")])])]),a("p",[t._v("查看映射端口配置")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" port "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("新建网络")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" network create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" bridge "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("net-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -d指定网络类型，bridge或overlay")]),t._v("\n")])])]),a("p",[t._v("连接容器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("container-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("net-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 容器连接到网络")]),t._v("\n")])])]),a("p",[t._v("获取挂载信息")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v("\n")])])]),a("p",[t._v("配置DNS，调整"),a("code",[t._v("、etc/docker/daemon.join")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dns"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v('\n        "'),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("114.114")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("114.114")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.8.8.8"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("查看容器DNS")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入容器的命令行后执行")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" etc/resolv.conf\n")])])]),a("h1",{attrs:{id:"相关问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关问题"}},[t._v("#")]),t._v(" 相关问题")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("无法启动docker")])])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /etc/init.d/docker start\n")])])]),a("h1",{attrs:{id:"相关技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关技术"}},[t._v("#")]),t._v(" 相关技术")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.docker.com/registry",target:"_blank",rel:"noopener noreferrer"}},[t._v("registry私有注册中心"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/goharbor/harbor",target:"_blank",rel:"noopener noreferrer"}},[t._v("harbor私有镜像管理"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.portainer.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("portainer容器管理及异常监控"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.gitlab.com/omnibus/docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitlab-ce代码管理仓库"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/ouyang_peng/article/details/84066417",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitlab内存占用过多问题"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/crper/article/details/81291034",target:"_blank",rel:"noopener noreferrer"}},[t._v("gitlab相关配置调整"),a("OutboundLink")],1)])]),t._v(" "),a("h1",{attrs:{id:"相关文献"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关文献"}},[t._v("#")]),t._v(" 相关文献")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker官方文档"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.funtl.com/zh/docs-docker",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker深入浅出"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.icodef.com/2019/06/15/1629",target:"_blank",rel:"noopener noreferrer"}},[t._v("WSL2"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-install",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft WSL2安装说明"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);